#################################################################################
# MAXANTAGENCY - CENTRALIZED ENVIRONMENT CONFIGURATION
#################################################################################
# IMPORTANT: This is the single source of truth for all environment variables
# All services (prospecting, analysis, outreach, pipeline, UI, database-tools)
# reference this file from the root directory.
#
# SETUP INSTRUCTIONS:
# 1. Copy this file to .env in the root directory
# 2. Fill in your actual API keys and credentials
# 3. Never commit the .env file to version control!
#################################################################################

#############################
# 1. DATABASE CONFIGURATION (SUPABASE)
#############################
# Used by: ALL services
# Get from: https://supabase.com/dashboard > Project Settings > API

SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_KEY=your-service-role-key-here

# Next.js UI specific (client-side public variables)
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_KEY=your-anon-or-service-key-here

#############################
# 2. AI PROVIDER API KEYS (REQUIRED)
#############################
# Used by: analysis-engine, prospecting-engine, outreach-engine, command-center-ui

# Anthropic Claude API - https://console.anthropic.com/
# Used for: Analysis agents, email composition, social DM generation
ANTHROPIC_API_KEY=sk-ant-api03-...

# OpenAI API - https://platform.openai.com/api-keys
# Used for: GPT-4o Vision, GPT-5/GPT-5-mini, prospect generation
OPENAI_API_KEY=sk-proj-...

# xAI Grok API - https://console.x.ai/
# Used for: Data extraction, company info, contact discovery
XAI_API_KEY=xai-...

#############################
# 3. GOOGLE APIs
#############################
# Used by: prospecting-engine
# Get from: https://console.cloud.google.com/

# Google Maps API
# Enable: Places API, Geocoding API
GOOGLE_MAPS_API_KEY=AIzaSy...

# Google Custom Search API
# https://developers.google.com/custom-search/v1/overview
GOOGLE_SEARCH_API_KEY=AIzaSy...
GOOGLE_SEARCH_ENGINE_ID=your-engine-id

#############################
# 4. SERVICE PORTS
#############################
# Individual service ports (used when running services independently)
# Default values are shown - uncomment to override

# Analysis Engine (default: 3001)
PORT=3001

# Outreach Engine (default: 3002)
# PORT=3002

# Prospecting Engine (default: 3010)
# PORT=3010

# Pipeline Orchestrator (default: 3020)
# PORT=3020

# Command Center UI (default: 3000)
# PORT=3000

#############################
# 5. MICROSERVICE API ENDPOINTS
#############################
# Used by: pipeline-orchestrator, command-center-ui
# Update these if deploying services to different hosts/ports

# Engine API URLs (local development defaults)
PROSPECTING_ENGINE_URL=http://localhost:3010
ANALYSIS_ENGINE_URL=http://localhost:3001
OUTREACH_ENGINE_URL=http://localhost:3002
ORCHESTRATOR_API=http://localhost:3020

# Next.js public endpoints (for client-side API calls)
NEXT_PUBLIC_PROSPECTING_API=http://localhost:3010
NEXT_PUBLIC_ANALYSIS_API=http://localhost:3001
NEXT_PUBLIC_OUTREACH_API=http://localhost:3002
NEXT_PUBLIC_ORCHESTRATOR_API=http://localhost:3020

# Legacy email composer URL (if still used)
EMAIL_COMPOSER_URL=http://localhost:3001

#############################
# 6. AI MODEL CONFIGURATION
#############################
# Used by: analysis-engine, outreach-engine

# Default models for different tasks
# Options: gpt-5-mini, gpt-5, gpt-4o, claude-sonnet-4-5, claude-haiku-4-5
DEFAULT_TEXT_MODEL=gpt-5-mini
DEFAULT_EMAIL_MODEL=claude-haiku-4-5

#############################
# 7. SENDER CONTACT INFORMATION
#############################
# Used by: analysis-engine, outreach-engine, command-center-ui
# Replaces placeholders like {{senderName}}, {{senderPhone}}, etc.

SENDER_NAME=Your Name
SENDER_WEBSITE=https://yourwebsite.com
SENDER_PHONE=123-456-7890
SENDER_COMPANY=Your Company

#############################
# 8. GMAIL INTEGRATION (OPTIONAL)
#############################
# Used by: analysis-engine, outreach-engine

# Gmail OAuth credentials (for draft creation)
# Get from: https://console.cloud.google.com/ > APIs & Services > Credentials
GMAIL_CLIENT_ID=your-client-id.apps.googleusercontent.com
GMAIL_CLIENT_SECRET=GOCSPX-...
GMAIL_REDIRECT_URI=http://localhost:3000/api/oauth/google/callback

# Gmail SMTP (for sending emails)
# Use Gmail App Password: https://myaccount.google.com/apppasswords
GMAIL_USER=your-email@gmail.com
GMAIL_APP_PASSWORD=your-app-password

# Email configuration
MAIL_FROM="Your Name <your-email@gmail.com>"
FROM_NAME=Your Name
SAVE_TO_DRAFTS=true
DRY_RUN=false

#############################
# 9. EMAIL SANITIZATION & HUMANIZATION
#############################
# Used by: analysis-engine, outreach-engine

USE_SANITIZER=true
SANITIZER_MODE=minimal  # Options: off, minimal, full

# Email length limits (characters)
SUBJECT_MAX=120
BODY_MAX=3000
OPENING_MAX=400

#############################
# 10. NOTION INTEGRATION (OPTIONAL)
#############################
# Used by: outreach-engine
# Get from: https://www.notion.so/my-integrations

NOTION_API_KEY=secret_...
NOTION_DATABASE_ID=your-database-id

#############################
# 11. PIPELINE ORCHESTRATOR CONFIGURATION
#############################
# Used by: pipeline-orchestrator

NODE_ENV=development

# Email notifications (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password
NOTIFICATION_FROM=noreply@yourcompany.com

# Budget settings (USD)
DEFAULT_DAILY_BUDGET=10.00
DEFAULT_WEEKLY_BUDGET=50.00
DEFAULT_MONTHLY_BUDGET=200.00

# Scheduler settings
TIMEZONE=America/New_York
ENABLE_CRON_ON_STARTUP=true

# Logging
LOG_LEVEL=info  # Options: error, warn, info, debug
LOG_FILE=./logs/orchestrator.log

#############################
# 12. PROSPECTING ENGINE CONFIGURATION
#############################
# Used by: prospecting-engine

# Pipeline defaults
DEFAULT_MIN_RATING=3.5  # Minimum Google rating (1.0 - 5.0)
DEFAULT_TIMEOUT=10000   # Website verification timeout (ms)
ENABLE_SOCIAL_SCRAPING=true

# Rate limiting
MAX_CONCURRENT_REQUESTS=5
REQUEST_DELAY_MS=1000

# Cost tracking
GOOGLE_MAPS_COST_PER_REQUEST=0.005  # USD
ENABLE_COST_TRACKING=true

#############################
# 13. ANALYSIS ENGINE - MODULE CONFIGURATION
#############################
# Used by: analysis-engine
# Enable/disable individual analyzers for isolated testing and cost control

# Analyzer Modules (set to false to disable specific analyzers during testing)
ENABLE_SEO_ANALYZER=true
ENABLE_CONTENT_ANALYZER=true
ENABLE_DESKTOP_VISUAL_ANALYZER=true
ENABLE_MOBILE_VISUAL_ANALYZER=true
ENABLE_SOCIAL_ANALYZER=true
ENABLE_ACCESSIBILITY_ANALYZER=true

# Unified Visual Analyzer (NEW - RECOMMENDED)
# When true: Analyzes desktop + mobile in ONE AI call (saves $0.005 + 10s per analysis)
# Captures responsive design issues (layout breaks between viewports) - unique insight!
# When false: Uses separate desktop and mobile analyzers (legacy mode, 2 AI calls)
USE_UNIFIED_VISUAL_ANALYZER=true

# Unified Technical Analyzer (NEW - RECOMMENDED)
# When true: Analyzes SEO + Content in ONE AI call (saves $0.008 + 20s per analysis)
# Identifies cross-cutting issues (heading hierarchy affects both SEO and readability)
# When false: Uses separate SEO and Content analyzers (legacy mode, 2 AI calls)
USE_UNIFIED_TECHNICAL_ANALYZER=true

# AI Synthesis Pipeline
# Consolidates issues and generates executive summary (~$0.06 per lead, adds 3.5 min)
USE_AI_SYNTHESIS=false

# Lead Scoring
# AI-powered lead qualification and priority scoring
ENABLE_LEAD_SCORING=true

# Multi-Page Analysis
ENABLE_MULTI_PAGE_CRAWL=true  # Set to false for single-page analysis only
MAX_PAGES_PER_MODULE=5        # Limit pages analyzed per module (cost control)

#############################
# 14. PERFORMANCE ANALYTICS INTEGRATION (FREE APIS)
#############################
# Used by: analysis-engine
# Integrates Google PageSpeed Insights and Chrome UX Report APIs
# Get from: https://console.cloud.google.com/ > Enable APIs > Create API Key

# Enable/Disable Performance Analytics
# When true: Adds Core Web Vitals (LCP, FID, CLS) and performance insights to analysis
# Provides real user metrics and Google ranking factor data
# Cost: FREE (50 requests/second limit)
ENABLE_PERFORMANCE_API=true

# PageSpeed Insights API
# What it provides:
#   - Core Web Vitals (LCP, FID, CLS, FCP, TTI) - Google ranking factors
#   - Performance score (0-100) for mobile and desktop
#   - Specific optimization opportunities with time savings
#   - Lab data (synthetic tests in controlled environment)
# Why it's valuable:
#   - Google ranking factor (Core Web Vitals affect SEO)
#   - Proven: 1s delay = 7% conversion loss
#   - Works on ANY website (no prior setup needed)
# Setup:
#   1. Go to https://console.cloud.google.com
#   2. Create new project or select existing
#   3. Enable "PageSpeed Insights API"
#   4. Go to Credentials > Create Credentials > API Key
#   5. Copy API key below
ENABLE_PAGESPEED_API=true
PAGESPEED_API_KEY=AIzaSy...your-key-here

# Chrome UX Report (CrUX) API
# What it provides:
#   - Real user metrics from Chrome browsers (field data)
#   - Core Web Vitals from actual visitors (not lab tests)
#   - Percentile breakdown (what % of users have good/poor experience)
#   - Device-specific data (phone vs desktop vs tablet)
# Why it's valuable:
#   - Field data beats lab tests (shows real user experience)
#   - Validates PageSpeed findings with actual visitor data
#   - Shows historical performance trends
# Limitation:
#   - Only works if site has enough Chrome traffic
#   - Small sites may not have data (will fallback to PageSpeed)
# Setup:
#   - Uses same API key as PageSpeed (already configured above)
ENABLE_CRUX_API=true
CRUX_API_KEY=  # Leave empty to use PAGESPEED_API_KEY

# Performance API Settings
PERFORMANCE_API_TIMEOUT=30000  # Max wait per API call (30 seconds)
PERFORMANCE_FAIL_GRACEFULLY=true  # Continue analysis if performance APIs fail

#############################
# 15. PROSPECTING ENGINE - MODULE TOGGLES
#############################
# Used by: prospecting-engine
# Enable/disable specific discovery sources

ENABLE_GOOGLE_MAPS_DISCOVERY=true
ENABLE_BUSINESS_INTELLIGENCE_EXTRACTION=true

#############################
# 16. OUTREACH ENGINE - MODULE TOGGLES
#############################
# Used by: outreach-engine
# Enable/disable outreach generation features

ENABLE_EMAIL_GENERATION=true
ENABLE_SOCIAL_MESSAGE_GENERATION=true

#############################
# 17. DEBUG AND TESTING
#############################
# Used by: ALL services
# Enable verbose logging and debug output for troubleshooting

# AI Call Debugging
DEBUG_AI_CALLS=false          # Log all AI prompts/responses to console
DEBUG_AI_SAVE_TO_FILE=false   # Save AI calls to debug files (creates timestamped logs)
DEBUG_OUTPUT_DIR=./debug-logs # Directory for debug output files

# General Debug Mode
DEBUG_MODE=false              # Enable verbose logging across all services

#################################################################################
# END OF CONFIGURATION
#################################################################################
#
# SETUP CHECKLIST:
# [ ] 1. Copy this file to .env in root directory
# [ ] 2. Add AI API Keys (Anthropic, OpenAI, xAI)
# [ ] 3. Add Google APIs (Maps, Custom Search) - if using prospecting
# [ ] 4. Add Supabase credentials
# [ ] 5. Configure Gmail OAuth/SMTP - if using email features
# [ ] 6. Configure Notion integration - if using Notion sync
# [ ] 7. Update sender contact information
# [ ] 8. Adjust service ports if needed
# [ ] 9. Review pipeline orchestrator settings
# [ ] 10. Configure module toggles (sections 13-15) for testing/cost control
# [ ] 11. Enable DEBUG_AI_CALLS=true for troubleshooting if needed
# [ ] 12. Test connection: cd database-tools && npm run db:validate
#
# IMPORTANT: All services now use this centralized .env file from the root.
# No need to maintain separate .env files in each service directory!
#
# TESTING TIP: Use the debug test script to see exactly what's happening:
#   cd analysis-engine
#   node tests/debug/test-transparent-analysis.js https://example.com
#################################################################################
