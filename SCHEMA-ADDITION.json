{
  "description": "Exact column and index additions for prospects.json - Business Intelligence Enhancement",
  "location": "prospecting-engine/database/schemas/prospects.json",
  "instructions": [
    "1. Open prospecting-engine/database/schemas/prospects.json",
    "2. Find the 'prompts_snapshot' column in the columns array",
    "3. Add business_intelligence column definition after prompts_snapshot",
    "4. Add GIN index definition to the indexes array",
    "5. Run: cd database-tools && npm run db:validate",
    "6. Run: npm run db:setup -- --dry-run",
    "7. Run: npm run db:setup"
  ],
  "column_to_add": {
    "name": "business_intelligence",
    "type": "jsonb",
    "default": null,
    "description": "Business intelligence data including company size, years in business, pricing visibility, content freshness, decision maker accessibility, and premium features. Populated during prospecting enrichment phase. Optional field (null if not enriched yet)."
  },
  "index_to_add": {
    "name": "idx_prospects_business_intelligence",
    "columns": ["business_intelligence"],
    "type": "gin",
    "description": "GIN index for efficient JSONB queries on business intelligence data"
  },
  "data_structure_reference": {
    "companySize": {
      "estimated_range": "10-50",
      "confidence": 0.85,
      "signals": ["team_page_mentions", "linkedin_reference"],
      "pages_found": ["about", "team"]
    },
    "yearsInBusiness": {
      "estimated_years": 8,
      "confidence": 0.75,
      "founded_year": 2016,
      "signals": ["about_page", "copyright_year", "domain_age"],
      "pages_found": ["about", "homepage"]
    },
    "pricingVisibility": {
      "visible": true,
      "type": "public",
      "price_points": ["$99/month", "$299/month"],
      "confidence": 0.9,
      "pages_found": ["pricing", "homepage"]
    },
    "contentFreshness": {
      "has_blog": true,
      "latest_post_date": "2025-10-15",
      "post_frequency": "weekly",
      "confidence": 0.8,
      "pages_found": ["blog"]
    },
    "decisionMakerAccessibility": {
      "has_contact_form": true,
      "has_phone": true,
      "has_email": true,
      "has_social": true,
      "pages_found": ["contact", "about", "homepage"]
    },
    "premiumFeatures": [
      {
        "feature": "SSL Certificate",
        "detected": true,
        "pages_found": ["homepage"]
      }
    ],
    "pageTypes": {
      "homepage": 1,
      "about": 1,
      "services": 1,
      "pricing": 1,
      "blog": 1,
      "contact": 1
    },
    "metadata": {
      "totalPagesAnalyzed": 7,
      "homepageFound": true,
      "timestamp": "2025-11-12T18:30:00.000Z"
    }
  },
  "database_commands": [
    "cd database-tools",
    "npm run db:validate",
    "npm run db:setup -- --dry-run",
    "npm run db:setup"
  ],
  "related_files": {
    "reference_implementation": [
      "analysis-engine/scrapers/business-intelligence-extractor.js",
      "analysis-engine/database/schemas/leads.json",
      "analysis-engine/services/results-aggregator.js"
    ],
    "files_to_update": [
      "prospecting-engine/database/schemas/prospects.json",
      "prospecting-engine/database/supabase-client.js",
      "prospecting-engine/README.md"
    ]
  },
  "query_examples": {
    "find_with_public_pricing": "SELECT * FROM prospects WHERE business_intelligence->'pricingVisibility'->>'visible' = 'true'",
    "find_high_confidence_size": "SELECT * FROM prospects WHERE (business_intelligence->'companySize'->>'confidence')::decimal > 0.8",
    "find_specific_size_range": "SELECT * FROM prospects WHERE business_intelligence->>'estimated_company_size' = '10-50'",
    "find_with_blog": "SELECT * FROM prospects WHERE business_intelligence->'contentFreshness'->>'has_blog' = 'true'"
  },
  "migration_properties": {
    "backward_compatible": true,
    "requires_data_migration": false,
    "impacts_existing_queries": false,
    "optional_enrichment": true,
    "default_value": "null"
  },
  "performance_characteristics": {
    "storage_per_record_minimal": "200 bytes",
    "storage_per_record_full": "800 bytes",
    "storage_per_record_average": "400 bytes",
    "index_overhead_percentage": "1-2%",
    "query_time_without_index": "50-200ms",
    "query_time_with_gin_index": "<5ms",
    "write_overhead": "~30% slower"
  }
}
